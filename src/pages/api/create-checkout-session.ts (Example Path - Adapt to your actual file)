import Stripe from 'stripe';
// ... other imports

// Initialize Stripe (ensure you have your secret key)
const stripe = new Stripe(process.env.STRIPE_SECRET_KEY!, {
  apiVersion: '2024-06-20', // Use the latest API version
});

// ... inside your API handler function ...
async function handler(req, res) {
  // ... existing code ...

  // Assuming you have your payment method types in an array like this:
  const paymentMethods: string[] = ['card', 'ideal', 'bancontact']; // Example array

  try {
    const session = await stripe.checkout.sessions.create({
      // ... other session parameters like line_items, mode, success_url, cancel_url ...

      payment_method_types: paymentMethods as Stripe.Checkout.SessionCreateParams.PaymentMethodType[], // <-- Cast the array here

      // ... rest of the parameters ...
    });

    // ... handle the session response ...
    res.status(200).json({ sessionId: session.id });

  } catch (error) {
    console.error('Error creating Stripe session:', error);
    res.status(500).json({ error: 'Could not create checkout session' });
  }
  // ... existing code ...
}

export default handler;
